def contraction_det_trace(x1, x2, l_n, l_t, t1, t2, d1): 
    det =(-d1**3*x1*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) + d1**3*x1*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) - d1**3*x1*l_t(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) + d1**3*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) - d1**3*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) - d1**3*x2**2*l_n(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) + d1**3*x2**2*l_n(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) - d1**3*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) + d1**3*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) + d1**3*x2**2*l_t(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) - d1**3*x2**2*l_t(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) + d1**3*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) - d1**3*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) - d1**3*x2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) + d1**3*x2*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) - d1**3*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1) - d1**3*x2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_t(x1, x2), x2) + d1**3*x2*l_t(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) - d1**3*x2*l_t(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) + d1**3*x2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) - d1**3*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**3 + 2*d1**2*x1**2*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) - 2*d1**2*x1**2*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) + d1**2*x1**2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) + 2*d1**2*x1**2*l_t(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) - d1**2*x1*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) + d1**2*x1*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) + d1**2*x1*x2**2*l_n(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) - d1**2*x1*x2**2*l_n(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) + d1**2*x1*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) - d1**2*x1*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) - d1**2*x1*x2**2*l_t(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) + d1**2*x1*x2**2*l_t(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) - 4*d1**2*x1*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) + 4*d1**2*x1*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) + d1**2*x1*x2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) - d1**2*x1*x2*l_n(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) - 2*d1**2*x1*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) + 2*d1**2*x1*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1) + 2*d1**2*x1*x2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_t(x1, x2), x2) - d1**2*x1*x2*l_t(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) + d1**2*x1*x2*l_t(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) - 3*d1**2*x1*x2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) + d1**2*x1*x2*l_t(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2) + d1**2*x1*l_n(x1, x2)**2*t2(x1, x2)**3 + 2*d1**2*x1*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**3 + d1**2*x2**3*l_n(x1, x2)*t1(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) - d1**2*x2**3*l_n(x1, x2)*t1(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) - d1**2*x2**3*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) + d1**2*x2**3*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) - d1**2*x2**3*l_t(x1, x2)*t1(x1, x2)**2*Derivative(l_t(x1, x2), x1)*Derivative(t2(x1, x2), x2) + d1**2*x2**3*l_t(x1, x2)*t1(x1, x2)**2*Derivative(l_t(x1, x2), x2)*Derivative(t2(x1, x2), x1) + d1**2*x2**3*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1)*Derivative(t1(x1, x2), x2) - d1**2*x2**3*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2)*Derivative(t1(x1, x2), x1) + 2*d1**2*x2**3*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) - 2*d1**2*x2**3*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) - d1**2*x2**2*l_n(x1, x2)**2*t1(x1, x2)**2*Derivative(t2(x1, x2), x1) + d1**2*x2**2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) + d1**2*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)**2*Derivative(t2(x1, x2), x1) - d1**2*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) + d1**2*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x2) - d1**2*x2**2*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**2*Derivative(t1(x1, x2), x2) + d1**2*x2**2*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1) - 2*d1**2*x2**2*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_t(x1, x2), x1) - 2*d1**2*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2) - d1**2*x2**2*l_t(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x2) + d1**2*x2**2*l_t(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x2) + d1**2*x2**2*l_t(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1) - d1**2*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) - d1**2*x2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)**2 - 2*d1**2*x2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2 - d1*x1**3*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) + d1*x1**3*x2*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) - 2*d1*x1**3*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) - d1*x1**3*l_t(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) + 3*d1*x1**2*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) - 3*d1*x1**2*x2**2*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) - d1*x1**2*x2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) + d1*x1**2*x2*l_n(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) + d1*x1**2*x2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x1) - d1*x1**2*x2*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**2*Derivative(t1(x1, x2), x1) + 5*d1*x1**2*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) - d1*x1**2*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x1) - d1*x1**2*x2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2) - d1*x1**2*x2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_t(x1, x2), x2) + 2*d1*x1**2*x2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) - d1*x1**2*x2*l_t(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2) - 2*d1*x1**2*l_n(x1, x2)**2*t2(x1, x2)**3 - d1*x1**2*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**3 - 3*d1*x1*x2**3*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) + 3*d1*x1*x2**3*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) + d1*x1*x2**2*l_n(x1, x2)**2*t1(x1, x2)**2*Derivative(t2(x1, x2), x1) - d1*x1*x2**2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) - d1*x1*x2**2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x2) + d1*x1*x2**2*l_n(x1, x2)**2*t2(x1, x2)**2*Derivative(t1(x1, x2), x2) - d1*x1*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)**2*Derivative(t2(x1, x2), x1) + d1*x1*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) + d1*x1*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t2(x1, x2), x2) - d1*x1*x2**2*l_n(x1, x2)*l_t(x1, x2)*t2(x1, x2)**2*Derivative(t1(x1, x2), x2) - 4*d1*x1*x2**2*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1) + 2*d1*x1*x2**2*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_t(x1, x2), x1) + 2*d1*x1*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) + 2*d1*x1*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2) - d1*x1*x2**2*l_t(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1) + 2*d1*x1*x2**2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) + 4*d1*x1*x2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)**2 + 2*d1*x1*x2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)**2 + d1*x2**4*t1(x1, x2)**3*Derivative(l_n(x1, x2), x1)*Derivative(l_t(x1, x2), x2) - d1*x2**4*t1(x1, x2)**3*Derivative(l_n(x1, x2), x2)*Derivative(l_t(x1, x2), x1) + d1*x2**3*l_n(x1, x2)**2*t1(x1, x2)**2*Derivative(t2(x1, x2), x2) - d1*x2**3*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x2) - d1*x2**3*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)**2*Derivative(t2(x1, x2), x2) + d1*x2**3*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x2) + d1*x2**3*l_n(x1, x2)*t1(x1, x2)**3*Derivative(l_n(x1, x2), x1) - d1*x2**3*l_n(x1, x2)*t1(x1, x2)**3*Derivative(l_t(x1, x2), x1) - d1*x2**3*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x2) - d1*x2**3*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_t(x1, x2), x2) - d1*x2**3*l_t(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x2) - 2*d1*x2**2*l_n(x1, x2)**2*t1(x1, x2)**2*t2(x1, x2) - d1*x2**2*l_n(x1, x2)*l_t(x1, x2)*t1(x1, x2)**2*t2(x1, x2) + x1**4*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x1) - 3*x1**3*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) + x1**3*x2*l_n(x1, x2)*t2(x1, x2)**3*Derivative(l_n(x1, x2), x2) + x1**3*l_n(x1, x2)**2*t2(x1, x2)**3 + 3*x1**2*x2**2*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x1) - 3*x1**2*x2**2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) - 3*x1**2*x2*l_n(x1, x2)**2*t1(x1, x2)*t2(x1, x2)**2 - x1*x2**3*l_n(x1, x2)*t1(x1, x2)**3*Derivative(l_n(x1, x2), x1) + 3*x1*x2**3*l_n(x1, x2)*t1(x1, x2)**2*t2(x1, x2)*Derivative(l_n(x1, x2), x2) + 3*x1*x2**2*l_n(x1, x2)**2*t1(x1, x2)**2*t2(x1, x2) - x2**4*l_n(x1, x2)*t1(x1, x2)**3*Derivative(l_n(x1, x2), x2) - x2**3*l_n(x1, x2)**2*t1(x1, x2)**3)/(-d1**3*t2(x1, x2)**3 + 3*d1**2*x1*t2(x1, x2)**3 - 3*d1**2*x2*t1(x1, x2)*t2(x1, x2)**2 - 3*d1*x1**2*t2(x1, x2)**3 + 6*d1*x1*x2*t1(x1, x2)*t2(x1, x2)**2 - 3*d1*x2**2*t1(x1, x2)**2*t2(x1, x2) + x1**3*t2(x1, x2)**3 - 3*x1**2*x2*t1(x1, x2)*t2(x1, x2)**2 + 3*x1*x2**2*t1(x1, x2)**2*t2(x1, x2) - x2**3*t1(x1, x2)**3) 
 
    tra =(-d1**2*x1*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) - d1**2*x2*l_n(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x1) + d1**2*x2*l_n(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) + d1**2*x2*l_t(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x1) - d1**2*x2*l_t(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) + d1**2*x2*t1(x1, x2)*t2(x1, x2)*Derivative(l_n(x1, x2), x1) - d1**2*x2*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1) - d1**2*x2*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2) - d1**2*l_n(x1, x2)*t2(x1, x2)**2 - d1**2*l_t(x1, x2)*t2(x1, x2)**2 + 2*d1*x1**2*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) + d1*x1*x2*l_n(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x1) - d1*x1*x2*l_n(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) - d1*x1*x2*l_t(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x1) + d1*x1*x2*l_t(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x1) - 3*d1*x1*x2*t1(x1, x2)*t2(x1, x2)*Derivative(l_n(x1, x2), x1) + d1*x1*x2*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x1) + d1*x1*x2*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) + d1*x1*x2*t2(x1, x2)**2*Derivative(l_t(x1, x2), x2) + 3*d1*x1*l_n(x1, x2)*t2(x1, x2)**2 + d1*x1*l_t(x1, x2)*t2(x1, x2)**2 + d1*x2**2*l_n(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x2) - d1*x2**2*l_n(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x2) - d1*x2**2*l_t(x1, x2)*t1(x1, x2)*Derivative(t2(x1, x2), x2) + d1*x2**2*l_t(x1, x2)*t2(x1, x2)*Derivative(t1(x1, x2), x2) + d1*x2**2*t1(x1, x2)**2*Derivative(l_n(x1, x2), x1) - d1*x2**2*t1(x1, x2)**2*Derivative(l_t(x1, x2), x1) - d1*x2**2*t1(x1, x2)*t2(x1, x2)*Derivative(l_n(x1, x2), x2) - d1*x2**2*t1(x1, x2)*t2(x1, x2)*Derivative(l_t(x1, x2), x2) - 3*d1*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2) - d1*x2*l_t(x1, x2)*t1(x1, x2)*t2(x1, x2) - x1**3*t2(x1, x2)**2*Derivative(l_n(x1, x2), x1) + 2*x1**2*x2*t1(x1, x2)*t2(x1, x2)*Derivative(l_n(x1, x2), x1) - x1**2*x2*t2(x1, x2)**2*Derivative(l_n(x1, x2), x2) - 2*x1**2*l_n(x1, x2)*t2(x1, x2)**2 - x1*x2**2*t1(x1, x2)**2*Derivative(l_n(x1, x2), x1) + 2*x1*x2**2*t1(x1, x2)*t2(x1, x2)*Derivative(l_n(x1, x2), x2) + 4*x1*x2*l_n(x1, x2)*t1(x1, x2)*t2(x1, x2) - x2**3*t1(x1, x2)**2*Derivative(l_n(x1, x2), x2) - 2*x2**2*l_n(x1, x2)*t1(x1, x2)**2)/(d1**2*t2(x1, x2)**2 - 2*d1*x1*t2(x1, x2)**2 + 2*d1*x2*t1(x1, x2)*t2(x1, x2) + x1**2*t2(x1, x2)**2 - 2*x1*x2*t1(x1, x2)*t2(x1, x2) + x2**2*t1(x1, x2)**2) 
 
    return det, tra 
